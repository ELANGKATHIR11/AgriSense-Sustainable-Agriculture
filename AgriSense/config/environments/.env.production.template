# =============================================================================
# AgriSense Production Environment Configuration
# Part of Production Optimization Blueprint
# 
# Copy this file to .env.production and customize for your deployment
# Never commit sensitive credentials to version control!
# =============================================================================

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_NAME=AgriSense
APP_VERSION=0.3.0
APP_ENV=production
DEBUG=false
LOG_LEVEL=info
ENABLE_DEBUG_LOGS=false

# API Configuration
API_HOST=0.0.0.0
API_PORT=8004
API_WORKERS=4
API_TIMEOUT=60
API_MAX_REQUESTS=10000
API_MAX_REQUESTS_JITTER=1000

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# ML Model Feature Flags
ENABLE_YIELD_MODEL=true
ENABLE_IRRIGATION_MODEL=true
ENABLE_DISEASE_MODEL=true
ENABLE_WEED_MODEL=true

# Disable ML entirely (use rule-based fallback only)
AGRISENSE_DISABLE_ML=false

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# JWT Authentication
# CRITICAL: Generate a secure secret key for production!
# Example: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE-THIS-TO-A-SECURE-RANDOM-SECRET-KEY-IN-PRODUCTION
JWT_ALGORITHM=HS256
JWT_EXP_MINUTES=15
REFRESH_TOKEN_EXP_DAYS=7

# Admin Credentials (Change these immediately!)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=CHANGE-THIS-PASSWORD-NOW
ADMIN_EMAIL=admin@yourdomain.com

# CORS Settings
ALLOWED_ORIGINS=https://yourdomain.com,https://api.yourdomain.com
ALLOW_CREDENTIALS=true

# Rate Limiting
AGRISENSE_DISABLE_RATE_LIMITING=false

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# SQLite (Development/Small deployments)
DATABASE_TYPE=sqlite
DATABASE_URL=sqlite+aiosqlite:///./data/agrisense.db

# MongoDB (Production - Uncomment and configure)
# DATABASE_TYPE=mongodb
# MONGO_CONNECTION_STRING=mongodb://username:password@localhost:27017/agrisense
# MONGO_DATABASE=agrisense
# MONGO_MAX_POOL_SIZE=100
# MONGO_MIN_POOL_SIZE=10

# Azure Cosmos DB (Cloud - Uncomment and configure)
# DATABASE_TYPE=cosmos
# COSMOS_CONNECTION_STRING=your-cosmos-connection-string
# COSMOS_DATABASE=agrisense
# COSMOS_CONTAINER=sensor_data

# =============================================================================
# CACHE CONFIGURATION (Redis)
# =============================================================================
CACHE_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Cache TTL (seconds)
CACHE_TTL_SENSOR=30
CACHE_TTL_PREDICTION=300
CACHE_TTL_ANALYTICS=600
CACHE_TTL_CROPS=3600

# =============================================================================
# BACKGROUND TASKS (Celery + Redis)
# =============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/1
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# Celery Worker Configuration
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000
CELERY_WORKER_PREFETCH_MULTIPLIER=4

# =============================================================================
# ML MODEL OPTIMIZATION
# =============================================================================
# Model Loading
ML_MODEL_LAZY_LOADING=true
ML_MODEL_CACHE_SIZE=10

# ONNX Runtime
ONNX_USE_GPU=false
ONNX_INTRA_OP_NUM_THREADS=4
ONNX_INTER_OP_NUM_THREADS=4

# TensorFlow (if used)
TF_CPP_MIN_LOG_LEVEL=2
TF_ENABLE_ONEDNN_OPTS=1

# PyTorch (if used)
TORCH_NUM_THREADS=4

# =============================================================================
# LOGGING AND OBSERVABILITY
# =============================================================================
# Structured JSON Logging
LOG_FORMAT=json
LOG_SAMPLING_RATE=1.0
LOG_FILE_PATH=./logs/agrisense.log
LOG_FILE_MAX_SIZE=100MB
LOG_FILE_BACKUP_COUNT=10

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Sentry Error Tracking (Optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# IOT DEVICE CONFIGURATION
# =============================================================================
# MQTT Broker
MQTT_ENABLED=false
MQTT_BROKER_HOST=localhost
MQTT_BROKER_PORT=1883
MQTT_USERNAME=
MQTT_PASSWORD=
MQTT_USE_TLS=false
MQTT_CLIENT_ID=agrisense-backend

# Device Security
DEVICE_CERTIFICATE_VALIDATION=true

# =============================================================================
# AI SERVICES (Optional)
# =============================================================================
# Azure OpenAI
AZURE_OPENAI_ENABLED=false
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview

# Hugging Face
HF_TOKEN=
HF_CACHE_DIR=./cache/huggingface

# =============================================================================
# NOTIFICATION SERVICES
# =============================================================================
# Email (SMTP)
EMAIL_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@yourdomain.com
SMTP_USE_TLS=true

# SMS (Twilio)
SMS_ENABLED=false
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# WhatsApp (Twilio)
WHATSAPP_ENABLED=false
WHATSAPP_FROM_NUMBER=whatsapp:+1234567890

# =============================================================================
# AUTOSCALING AND PERFORMANCE
# =============================================================================
# Autoscaling Triggers
AUTOSCALE_ENABLED=false
AUTOSCALE_MIN_INSTANCES=2
AUTOSCALE_MAX_INSTANCES=10
AUTOSCALE_TARGET_CPU=70
AUTOSCALE_TARGET_MEMORY=80
AUTOSCALE_SCALE_UP_THRESHOLD=80
AUTOSCALE_SCALE_DOWN_THRESHOLD=30

# Request Queue Management
MAX_QUEUE_SIZE=1000
REQUEST_TIMEOUT=30

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================
# Local Storage
DATA_DIR=./data
UPLOAD_DIR=./uploads
MAX_UPLOAD_SIZE_MB=10

# Azure Blob Storage (Optional)
# AZURE_STORAGE_CONNECTION_STRING=
# AZURE_STORAGE_CONTAINER=agrisense

# =============================================================================
# BACKUP AND RETENTION
# =============================================================================
# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=./backups

# Data Retention
SENSOR_DATA_RETENTION_DAYS=90
LOG_RETENTION_DAYS=30

# =============================================================================
# MONITORING ENDPOINTS
# =============================================================================
HEALTH_CHECK_ENABLED=true
METRICS_ENDPOINT_ENABLED=true
DEBUG_ENDPOINTS_ENABLED=false

# =============================================================================
# NOTES:
# 
# 1. Replace all CHANGE-THIS placeholders with actual values
# 2. Use Azure Key Vault or AWS Secrets Manager for production secrets
# 3. Enable TLS/SSL in production with proper certificates
# 4. Configure firewall rules to restrict access
# 5. Set up monitoring and alerting (Prometheus + Grafana recommended)
# 6. Regular security audits and dependency updates
# 7. Backup strategy should be tested regularly
# 
# =============================================================================
